---
sidebar: sidebar
permalink: vmware/vmware-vsphere-dp.html
keywords: Data protection, Space reclamation, VM and datastore cloning, Storage efficiency, thin provisioning, QoS, SIOC, Storage Distributed Resource Scheduler, DRS, Active IQ Unified Manager, Encryption
summary: SnapCenter allows you to create backup policies that can be applied to multiple jobs. These policies can define schedule, retention, replication, and other capabilities. They continue to allow an optional selection of VM-consistent snapshots, which leverages the hypervisor's ability to quiesce I/O before taking a VMware snapshot.
---
= Data protection
:hardbreaks:
:nofooter:
:icons: font
:linkattrs:
:imagesdir: ../media/

[.lead]
Backing up and quickly recovering your virtual machines (VMs) are key advantages of using ONTAP for vSphere. This functionality can be easily managed within vCenter through the SnapCenter Plug-In for VMware vSphere. Many customers enhance their third-party backup solutions with SnapCenter to leverage ONTAPâ€™s snapshot technology, as it offers the fastest and most straightforward way to recover a VM with ONTAP. SnapCenter is available for free to customers who have the ONTAP One license, and other license bundles may also be available.

Additionally, the SnapCenter Plug-In for VMware can integrate with https://docs.netapp.com/us-en/data-services-backup-recovery/concept-protect-vm-data.html[NetApp Backup and Recovery for virtual machines^], enabling effective 3-2-1 backup solutions for most ONTAP systems. Note that some fees may apply if using Backup and Recovery for virtual machines with premium services, such as object stores for additional backup storage. This section outlines the various options available for protecting your VMs and datastores.

== NetApp ONTAP volume snapshots 

Use snapshots to make quick copies of your VM or datastore without affecting performance, and then send them to a secondary system using SnapMirror for longer-term off-site data protection. This approach minimizes storage space and network bandwidth by only storing changed information.

Snapshots are a key feature of ONTAP, allowing you to create point-in-time copies of your data. They are space-efficient and can be created quickly, making them ideal for protecting VMs and datastores. Snapshots can be used for various purposes, including backup, recovery, and testing. These snapshots are different from VMware (consistency) snapshots and are suitable for longer-term protection. VMware's vCenter-managed snapshots are only recommended for short-term use due to performance and other effects. Refer to link:https://techdocs.broadcom.com/us/en/vmware-cis/vsphere/vsphere/8-0/snapshot-limitations.html[Snapshot Limitations^] for more details.

Snapshots are created at the volume level, and they can be used to protect all the VMs and datastores within that volume. This means that you can create a snapshot of an entire datastore, which includes all the VMs within that datastore.

For NFS datastores, you can easily view VM files in snapshots by browsing the .snapshots directory. This allows you to quickly access and restore files from a snapshot without needing to use a specific backup solution.

For VMFS datastores, you can create a FlexClone of the datastore based on the desired snapshot. This allows you to create a new datastore that is based on the snapshot, which can be used for testing or development purposes. The FlexClone will only consume space for the changes made after the snapshot was taken, making it a space-efficient way to create a copy of the datastore. Once the FlexClone is created, you can map the LUN or namespace to an ESXi host just like a regular datastore. Not only does this allow you to restore specific VM files, but it allows you to quickly create test or development environments based on production data without impacting the performance of the production environment.

For more information on snapshots, refer to the ONTAP documentation. The following links provide additional details:
https://docs.netapp.com/us-en/ontap/data-protection/manage-local-snapshot-copies-concept.html[ONTAP local snapshot copies^]
https://docs.netapp.com/us-en/ontap/data-protection/manage-snapmirror-replication.html[ONTAP SnapMirror replication^]

== SnapCenter Plug-In for VMware vSphere

SnapCenter allows you to create backup policies that can be applied to multiple jobs. These policies can define schedule, retention, replication, and other capabilities. They continue to allow an optional selection of VM-consistent snapshots, which leverages the hypervisor's ability to quiesce I/O before taking a VMware snapshot. However, due to the performance effect of VMware snapshots, they are generally not recommended unless you need the guest file system to be quiesced. Instead, use snapshots for general protection, and use application tools such as SnapCenter application plug-ins to protect transactional data such as SQL Server or Oracle. 

These plug-ins offer extended capabilities to protect the databases in both physical and virtual environments. With vSphere, you can use them to protect SQL Server or Oracle databases where data is stored on RDM LUNs, vVols, or NVMe/TCP namespaces and iSCSI LUNs directly connected to the guest OS, or VMDK files on either VMFS or NFS datastores. The plug-ins allow the specification of different types of database backups, supporting online or offline backup, and protecting database files along with log files. In addition to backup and recovery, the plug-ins also support the cloning of databases for development or test purposes.

The following figure depicts an example of SnapCenter deployment.

image:vsphere_ontap_image4.png[SnapCenter deployment]

For sizing information, refer to the https://kb.netapp.com/data-mgmt/SnapCenter/SC_KBs/SCV__Sizing_Guide_for_SnapCenter_Plugin_for_VMware_vSphere[Sizing Guide for SnapCenter Plugin for VMware vSphere^]

== ONTAP tools for VMware vSphere with VMware Live Site Recovery

The ONTAP tools for VMware vSphere (OT4VS) is a free plug-in that provides a seamless integration between VMware vSphere and NetApp ONTAP. It allows you to manage your ONTAP storage directly from the vSphere Web Client, making it easier to perform tasks such as provisioning storage, managing replication, and monitoring performance.

For improved disaster recovery capabilities, consider utilizing the NetApp SRA for ONTAP, which is part of ONTAP tools for VMware vSphere, alongside VMware Live Site Recovery (formerly known as Site Recovery Manager). This tool not only supports the replication of datastores to a disaster recovery site using SnapMirror, but it also allows for nondisruptive testing in the DR environment by cloning the replicated datastores. Additionally, recovery from a disaster and reprotecting production after resolving an outage is streamlined thanks to the built-in automation features.

== NetApp Disaster Recovery

Disaster Recovery (DR) is a cloud-based service that provides a comprehensive solution for protecting your data and applications in the event of a disaster. It offers a range of features, including automated failover and failback, multiple point-in-time recovery points, application-consistent disaster recovery, and support for both on-prem and cloud-based ONTAP systems. NetApp Disaster Recovery is designed to work seamlessly with ONTAP and your VMware vSphere environment, providing a unified solution for disaster recovery.

== vSphere Metro Storage Cluster (vMSC) with NetApp MetroCluster and SnapMirror active sync

Finally, for the highest level of data protection, consider a VMware vSphere Metro Storage Cluster (vMSC) configuration using NetApp MetroCluster. vMSC is a VMware-certified, NetApp supported solution that uses synchronous replication, giving the same benefits of a high-availability cluster but distributed across separate sites to protect against site disaster. NetApp SnapMirror active sync, with ASA and AFF, and MetroCluster with AFF, offers cost-effective configurations for synchronous replication with transparent recovery from any single storage component failure as well as transparent recovery in the case of SnapMirror active sync, or single-command recovery in the event of a site disaster with MetroCluster. vMSC is described in greater detail in https://www.netapp.com/pdf.html?item=/media/19773-tr-4128.pdf[TR-4128^].
